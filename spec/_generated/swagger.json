{
    "openapi": "3.0.0",
    "components": {
        "examples": {},
        "headers": {},
        "parameters": {},
        "requestBodies": {},
        "responses": {},
        "schemas": {
            "RunnableMetric": {
                "description": "A metric associated to a runnable",
                "properties": {
                    "label": {
                        "type": "string",
                        "nullable": true,
                        "description": "Try to keep it short to have a great and more readable display in the app (i.e. \"CPU\", \"RAM\", \"Proc #\")"
                    },
                    "ratio": {
                        "type": "number",
                        "format": "double",
                        "nullable": true,
                        "description": "The ratio of the value compared to its maximum.\nFor example, if you have 1024 of RAM and 256 are being used, the ratio should be 256 / 1024 = 0.25",
                        "maximum": 1,
                        "minimum": 0
                    },
                    "thresholds": {
                        "items": {
                            "type": "number",
                            "format": "double"
                        },
                        "type": "array",
                        "nullable": true,
                        "description": "If provided, it must be an array of two numbers.\nThey respectively define the limits for \"warning\" and \"danger\".\nTo illustrate with CPU usage, these values could be [60, 80].\nIn this case, if value < 60, it will be \"success\".\nIf value < 80 it will be \"warning\".\nEverything else will be \"danger\".\nIf the first value is greater than the second one (i.e. higher is better), the semantics are reversed.",
                        "maxItems": 2,
                        "minItems": 2
                    },
                    "unit": {
                        "type": "string",
                        "nullable": true,
                        "description": "Like for the label, try to keep it short to have a great and more readable display (i.e. \"MB\", \"%\", \"GB/s\")"
                    },
                    "value": {
                        "type": "number",
                        "format": "double",
                        "nullable": true,
                        "description": "Format it so it's displayed correctly in the app.\nIf it's a percentage, unlike ratio, put directly the actual value (i.e. 25 and not 0.25)"
                    }
                },
                "required": ["label", "ratio", "thresholds", "unit", "value"],
                "type": "object",
                "additionalProperties": false
            },
            "RunnableScope": {
                "description": "The context in which a runnable is\nIt can be `geo`, defining the geographical zone where the runnable is (e.g. AWS regions code).\nIt can also be `logical`, defining an abstract structure where the runnable is (e.g. GCP project).",
                "properties": {
                    "label": {
                        "type": "string"
                    },
                    "value": {
                        "type": "string"
                    }
                },
                "required": ["label", "value"],
                "type": "object",
                "additionalProperties": false
            },
            "RunnableScopes": {
                "description": "The scopes in which the runnable is",
                "properties": {
                    "geo": {
                        "allOf": [
                            {
                                "$ref": "#/components/schemas/RunnableScope"
                            }
                        ],
                        "nullable": true
                    },
                    "logical": {
                        "allOf": [
                            {
                                "$ref": "#/components/schemas/RunnableScope"
                            }
                        ],
                        "nullable": true
                    }
                },
                "required": ["geo", "logical"],
                "type": "object",
                "additionalProperties": false
            },
            "RunnableSSH": {
                "description": "The configuration to define how to SSH into the runnable",
                "properties": {
                    "keyName": {
                        "type": "string",
                        "nullable": true
                    },
                    "port": {
                        "type": "integer",
                        "format": "int32",
                        "minimum": 0
                    },
                    "username": {
                        "type": "string"
                    }
                },
                "required": ["keyName", "port", "username"],
                "type": "object",
                "additionalProperties": false
            },
            "RunnableStatus": {
                "description": "The status of a runnable\nAny intermediary status that you have on your side must be mapped to the `pending` status.",
                "enum": ["off", "on", "pending", "unknown"],
                "type": "string"
            },
            "Runnable": {
                "description": "Anything that runs, can be stopped and rebooted\nTypical examples are cloud VMs, containers, PaaS applications, etc.",
                "properties": {
                    "flavor": {
                        "type": "string",
                        "nullable": true
                    },
                    "fqdn": {
                        "type": "string",
                        "nullable": true
                    },
                    "id": {
                        "type": "string"
                    },
                    "ipv4": {
                        "type": "string",
                        "nullable": true
                    },
                    "metrics": {
                        "items": {
                            "$ref": "#/components/schemas/RunnableMetric"
                        },
                        "type": "array",
                        "nullable": true
                    },
                    "name": {
                        "type": "string"
                    },
                    "scopes": {
                        "$ref": "#/components/schemas/RunnableScopes"
                    },
                    "ssh": {
                        "allOf": [
                            {
                                "$ref": "#/components/schemas/RunnableSSH"
                            }
                        ],
                        "nullable": true
                    },
                    "stack": {
                        "type": "string",
                        "nullable": true
                    },
                    "status": {
                        "$ref": "#/components/schemas/RunnableStatus"
                    }
                },
                "required": [
                    "flavor",
                    "fqdn",
                    "id",
                    "ipv4",
                    "metrics",
                    "name",
                    "scopes",
                    "ssh",
                    "stack",
                    "status"
                ],
                "type": "object",
                "additionalProperties": false
            },
            "ListRes_Runnable_": {
                "properties": {
                    "items": {
                        "items": {
                            "$ref": "#/components/schemas/Runnable"
                        },
                        "type": "array"
                    },
                    "total": {
                        "type": "integer",
                        "format": "int32",
                        "minimum": 0
                    }
                },
                "required": ["items", "total"],
                "type": "object",
                "additionalProperties": false
            },
            "ListRunnablesRes": {
                "$ref": "#/components/schemas/ListRes_Runnable_"
            },
            "ErrorRes": {
                "properties": {
                    "message": {
                        "type": "string",
                        "description": "Provided in english in a human readable way"
                    }
                },
                "required": ["message"],
                "type": "object",
                "additionalProperties": false
            },
            "ListRunnablesQueryParams": {
                "properties": {
                    "limit": {
                        "type": "integer",
                        "format": "int32",
                        "description": "Max number of items to return in the response. Set a reasonable default value (e.g. `50`) in your implementation. Avoid returning too many items at once for client performance reasons.",
                        "minimum": 0
                    },
                    "offset": {
                        "type": "integer",
                        "format": "int32",
                        "description": "Cursor from where to start fetching when paginating. The default value should be `0`.",
                        "minimum": 0
                    },
                    "q": {
                        "type": "string",
                        "description": "Filter on one or multiple properties. It's up to you to implement the filtering that you want. It can be as simple as equality check on one specific field (e.g. `name`). It can also be a partial check (e.g. `ILIKE` pattern) on multiple fields."
                    }
                },
                "type": "object",
                "additionalProperties": false
            },
            "RunnableOperationRes": {
                "description": "The response of a reboot, stop operation",
                "properties": {
                    "jobId": {
                        "type": "string",
                        "nullable": true,
                        "description": "If the operation is triggered via an asynchronous queue and will eventually succeed, the id can be provided here for information"
                    }
                },
                "required": ["jobId"],
                "type": "object",
                "additionalProperties": false
            },
            "DashboardMetric": {
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "label": {
                        "type": "string",
                        "nullable": true,
                        "description": "Unlike `RunnableMetric`, this label can be longer to fit your needs"
                    },
                    "unit": {
                        "type": "string",
                        "nullable": true,
                        "description": "Try to keep it short to have a great and more readable display (i.e. \"MB\", \"%\", \"GB/s\")"
                    },
                    "value": {
                        "type": "number",
                        "format": "double",
                        "nullable": true,
                        "description": "Format it so it's displayed correctly in the app.\nIf it's a percentage, unlike ratio, put directly the actual value (i.e. 25 and not 0.25)"
                    }
                },
                "required": ["id", "label", "unit", "value"],
                "type": "object",
                "additionalProperties": false
            },
            "Dashboard": {
                "description": "A collection of metrics",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "metrics": {
                        "items": {
                            "$ref": "#/components/schemas/DashboardMetric"
                        },
                        "type": "array",
                        "nullable": true
                    },
                    "name": {
                        "type": "string"
                    }
                },
                "required": ["id", "metrics", "name"],
                "type": "object",
                "additionalProperties": false
            },
            "ListRes_Dashboard_": {
                "properties": {
                    "items": {
                        "items": {
                            "$ref": "#/components/schemas/Dashboard"
                        },
                        "type": "array"
                    },
                    "total": {
                        "type": "integer",
                        "format": "int32",
                        "minimum": 0
                    }
                },
                "required": ["items", "total"],
                "type": "object",
                "additionalProperties": false
            },
            "ListDashboardsRes": {
                "$ref": "#/components/schemas/ListRes_Dashboard_"
            },
            "ListDashboardsQueryParams": {
                "properties": {
                    "limit": {
                        "type": "integer",
                        "format": "int32",
                        "description": "Max number of items to return in the response. Set a reasonable default value (e.g. `50`) in your implementation. Avoid returning too many items at once for client performance reasons.",
                        "minimum": 0
                    },
                    "offset": {
                        "type": "integer",
                        "format": "int32",
                        "description": "Cursor from where to start fetching when paginating. The default value should be `0`.",
                        "minimum": 0
                    },
                    "q": {
                        "type": "string",
                        "description": "Filter on one or multiple properties. It's up to you to implement the filtering that you want. It can be as simple as equality check on one specific field (e.g. `name`). It can also be a partial check (e.g. `ILIKE` pattern) on multiple fields."
                    }
                },
                "type": "object",
                "additionalProperties": false
            }
        },
        "securitySchemes": {
            "authorizationHeader": {
                "in": "header",
                "name": "authorization",
                "type": "apiKey"
            }
        }
    },
    "info": {
        "title": "RebootX On-Prem Specification",
        "version": "0.2.1",
        "description": "Find all the details about this specification on the [GitHub repository](https://github.com/c100k/rebootx-on-prem)."
    },
    "paths": {
        "/runnables": {
            "get": {
                "operationId": "ListRunnables",
                "responses": {
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ListRunnablesRes"
                                },
                                "examples": {
                                    "A list of items with their name, status, etc.": {
                                        "value": {
                                            "items": [
                                                {
                                                    "flavor": "medium",
                                                    "fqdn": "server01.mycompany.com",
                                                    "id": "123",
                                                    "ipv4": "192.168.0.26",
                                                    "metrics": [
                                                        {
                                                            "label": "CPU",
                                                            "ratio": null,
                                                            "thresholds": [
                                                                65, 85
                                                            ],
                                                            "unit": "%",
                                                            "value": 28
                                                        },
                                                        {
                                                            "label": "RAM",
                                                            "ratio": 0.125,
                                                            "thresholds": [
                                                                3000, 3800
                                                            ],
                                                            "unit": "MB",
                                                            "value": 512
                                                        }
                                                    ],
                                                    "name": "server01",
                                                    "scopes": {
                                                        "geo": {
                                                            "label": "Paris 01",
                                                            "value": "par-01"
                                                        },
                                                        "logical": {
                                                            "label": "Project 1",
                                                            "value": "project-1"
                                                        }
                                                    },
                                                    "ssh": {
                                                        "keyName": "keypair-01",
                                                        "port": 22,
                                                        "username": "admin"
                                                    },
                                                    "stack": "nodejs",
                                                    "status": "off"
                                                },
                                                {
                                                    "flavor": "medium",
                                                    "fqdn": "server02.mycompany.com",
                                                    "id": "456",
                                                    "ipv4": "192.168.0.27",
                                                    "metrics": [
                                                        {
                                                            "label": "CPU",
                                                            "ratio": null,
                                                            "thresholds": [
                                                                65, 85
                                                            ],
                                                            "unit": "%",
                                                            "value": 82
                                                        },
                                                        {
                                                            "label": "RAM",
                                                            "ratio": 0.25,
                                                            "thresholds": [
                                                                3000, 3800
                                                            ],
                                                            "unit": "GB",
                                                            "value": 1
                                                        }
                                                    ],
                                                    "name": "server02",
                                                    "scopes": {
                                                        "geo": {
                                                            "label": "Paris 01",
                                                            "value": "par-01"
                                                        },
                                                        "logical": {
                                                            "label": "Project 1",
                                                            "value": "project-1"
                                                        }
                                                    },
                                                    "ssh": {
                                                        "keyName": "keypair-01",
                                                        "port": 22,
                                                        "username": "admin"
                                                    },
                                                    "stack": "go",
                                                    "status": "off"
                                                }
                                            ],
                                            "total": 2
                                        }
                                    },
                                    "An empty list": {
                                        "value": {
                                            "items": [],
                                            "total": 0
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Authentication required"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Operation forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Operation forbidden"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "description": "List the runnables with their name, status, etc.",
                "summary": "List the runnables",
                "tags": ["Runnable"],
                "security": [
                    {
                        "authorizationHeader": []
                    }
                ],
                "parameters": [
                    {
                        "description": "Max number of items to return in the response. Set a reasonable default value (e.g. `50`) in your implementation. Avoid returning too many items at once for client performance reasons.",
                        "in": "query",
                        "name": "limit",
                        "required": false,
                        "schema": {
                            "format": "int32",
                            "type": "integer",
                            "minimum": 0
                        }
                    },
                    {
                        "description": "Cursor from where to start fetching when paginating. The default value should be `0`.",
                        "in": "query",
                        "name": "offset",
                        "required": false,
                        "schema": {
                            "format": "int32",
                            "type": "integer",
                            "minimum": 0
                        }
                    },
                    {
                        "description": "Filter on one or multiple properties. It's up to you to implement the filtering that you want. It can be as simple as equality check on one specific field (e.g. `name`). It can also be a partial check (e.g. `ILIKE` pattern) on multiple fields.",
                        "in": "query",
                        "name": "q",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ]
            }
        },
        "/runnables/{id}/reboot": {
            "post": {
                "operationId": "Reboot",
                "responses": {
                    "201": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/RunnableOperationRes"
                                },
                                "examples": {
                                    "The operation has been executed asynchronously and will eventually succeed": {
                                        "value": {
                                            "jobId": "e22df54c-09b2-47cc-be7f-128b15e609c4"
                                        }
                                    },
                                    "The operation has been successfully executed synchronously": {
                                        "value": {
                                            "jobId": null
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Authentication required"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Operation forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Operation forbidden"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Not found"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "description": "Reboot a runnable",
                "summary": "Reboot a runnable",
                "tags": ["Runnable"],
                "security": [
                    {
                        "authorizationHeader": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ]
            }
        },
        "/runnables/{id}/stop": {
            "post": {
                "operationId": "Stop",
                "responses": {
                    "201": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/RunnableOperationRes"
                                },
                                "examples": {
                                    "The operation has been executed asynchronously and will eventually succeed": {
                                        "value": {
                                            "jobId": "e22df54c-09b2-47cc-be7f-128b15e609c4"
                                        }
                                    },
                                    "The operation has been successfully executed synchronously": {
                                        "value": {
                                            "jobId": null
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Authentication required"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Operation forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Operation forbidden"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Not found"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "description": "Stop a runnable",
                "summary": "Stop a runnable",
                "tags": ["Runnable"],
                "security": [
                    {
                        "authorizationHeader": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ]
            }
        },
        "/dashboards": {
            "get": {
                "operationId": "ListDashboards",
                "responses": {
                    "200": {
                        "description": "",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ListDashboardsRes"
                                },
                                "examples": {
                                    "A list of items with their id, name, etc.": {
                                        "value": {
                                            "items": [
                                                {
                                                    "id": "123",
                                                    "metrics": [],
                                                    "name": "Infra"
                                                },
                                                {
                                                    "id": "456",
                                                    "metrics": [
                                                        {
                                                            "id": "123",
                                                            "label": "Clients #",
                                                            "unit": null,
                                                            "value": 612
                                                        },
                                                        {
                                                            "id": "456",
                                                            "label": "Turnover",
                                                            "unit": "â‚¬",
                                                            "value": null
                                                        },
                                                        {
                                                            "id": "789",
                                                            "label": "NPS",
                                                            "unit": null,
                                                            "value": 95
                                                        }
                                                    ],
                                                    "name": "Business"
                                                }
                                            ],
                                            "total": 2
                                        }
                                    },
                                    "An empty list": {
                                        "value": {
                                            "items": [],
                                            "total": 0
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication required",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Authentication required"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Operation forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorRes"
                                },
                                "examples": {
                                    "Example 1": {
                                        "value": {
                                            "message": "Operation forbidden"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "description": "List the dashboards with their id, name, etc.",
                "summary": "List the dashboards",
                "tags": ["Dashboard"],
                "security": [
                    {
                        "authorizationHeader": []
                    }
                ],
                "parameters": [
                    {
                        "description": "Max number of items to return in the response. Set a reasonable default value (e.g. `50`) in your implementation. Avoid returning too many items at once for client performance reasons.",
                        "in": "query",
                        "name": "limit",
                        "required": false,
                        "schema": {
                            "format": "int32",
                            "type": "integer",
                            "minimum": 0
                        }
                    },
                    {
                        "description": "Cursor from where to start fetching when paginating. The default value should be `0`.",
                        "in": "query",
                        "name": "offset",
                        "required": false,
                        "schema": {
                            "format": "int32",
                            "type": "integer",
                            "minimum": 0
                        }
                    },
                    {
                        "description": "Filter on one or multiple properties. It's up to you to implement the filtering that you want. It can be as simple as equality check on one specific field (e.g. `name`). It can also be a partial check (e.g. `ILIKE` pattern) on multiple fields.",
                        "in": "query",
                        "name": "q",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ]
            }
        }
    },
    "servers": [
        {
            "url": "http://localhost:9001/cd5331ba/"
        }
    ]
}
